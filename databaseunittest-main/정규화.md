# 🚀 정규화(Normalization)

### — 함수적 종속성(FD), 이상(Anomaly), 키 이론, 1NF~BCNF까지 이해하기

정규화는 데이터베이스 설계의 근간이 되는 이론으로,
정규화를 이해하면 **중복 데이터 제거·데이터 일관성 유지·성능/확장성 향상**이라는
DB 모델링의 핵심 목표를 제대로 달성할 수 있습니다.

정규화를 깊게 이해하려면 단순 규칙 암기가 아니라
**“왜 이 정규형이 만들어졌는가?”**
**“이상이 왜 발생하며, 정규화가 어떻게 해결하는가?”**
를 이해해야 합니다.

---

# 1️⃣ 정규화란 무엇인가? (정식 정의)

> **정규화는 데이터 구조에서 중복과 이상(Anomaly)을 제거하기 위해
> 엔터티를 함수적 종속성(FD: Functional Dependency)을 기준으로 분해하는 과정**
> 이다.

핵심 키워드:

* **함수적 종속성 (Functional Dependency)**
* **이상(Anomaly)**
* **키(Key) 이론**
* **엔터티 분해(Decomposition)**
* **정보 손실 없는 분해(Non-loss decomposition)**

정규화는 단순히 규칙을 따르는 것이 아니라,
“데이터가 어떻게 종속되는가”를 정확히 분석하여
**데이터 이상(Anomaly)** 을 해결하는 과정이다.

---

# 2️⃣ 이상(Anomaly)이란 무엇인가? (정규화의 필요성)

정규화가 왜 필요한지 알려면 “이상”이 무엇인지 이해해야 합니다.

### ✔ 1) 삽입 이상 (Insertion Anomaly)

필요한 데이터를 삽입하려면 다른 불필요한 데이터도 강제로 넣어야 하는 문제.

예:
학생과 강의를 한 테이블에 넣으면,
수강하지 않은 강의를 가진 학생은 입력할 수 없음.

---

### ✔ 2) 삭제 이상 (Deletion Anomaly)

어떤 데이터를 삭제하면 **필요한 다른 데이터까지 사라지는 문제**

예:
“학생–수강기록”이 한 테이블에 있을 때
수강기록 1건을 지우면 학생 정보도 사라질 수 있음.

---

### ✔ 3) 갱신 이상 (Update Anomaly)

동일한 정보가 여러 행에 중복 저장되어
수정 시 **모든 데이터가 정확히 수정되지 않으면 데이터 불일치 발생**

예:
강사 이메일이 20행에 중복되어 있으면
한 곳만 수정되면 불일치 발생.

---

이상을 해결하기 위해 **정규화가 반드시 필요**하다.

---

# 3️⃣ 함수적 종속성(Functional Dependency, FD) — 정규화의 수학적 기반

정규화를 진짜 이해하려면 FD(함수적 종속성)를 이해해야 함.

> **X → Y 라는 FD는, X 값이 주어지면 Y 값이 반드시 1개로 결정된다는 것.**

예:

```
주민번호 → 이름  
주문번호 → 주문일자  
(학생ID, 강의ID) → 성적  
```

FD 속성:

* 결정자(Determinant): 왼쪽(X)
* 종속자(Dependent): 오른쪽(Y)
* FD가 잘못 구성되면 이상 발생
* 정규화는 FD 기반으로 분해하는 과정

---

# 4️⃣ 키(Key)와 정규화의 관계

정규형 판별의 핵심은 대부분 **키와 FD**이다.

### ✔ 후보키(Candidate Key)

행을 식별할 수 있는 최소 속성 집합

### ✔ 기본키(PK)

후보키 중 선택된 키

### ✔ 부분 종속(Partial Dependency)

복합키의 일부에만 종속되는 경우 → 2NF 위반

### ✔ 이행 종속(Transitive Dependency)

A → B, B → C 가 있을 때 A → C이지만
C가 A의 직접 종속자가 아닌 경우 → 3NF 위반

---

# ⭐ 5️⃣ 1NF~BCNF까지 (전문가 레벨 설명)

단순 설명이 아니라 “왜 이런 규칙이 생겼는지”까지 설명합니다.

---

## 1️⃣ 제1정규형(1NF) — 원자성(Atomicity)

조건:

* 테이블의 모든 속성은 더 이상 분해할 수 없는 **원자값(Atomic Value)** 이어야 한다.

예 (1NF 위반):

```
주소: "서울시 강남구, 대구시 중구"
전화번호: "010-1234-5678, 02-111-2222"
```

이유:

* 주소/전화번호가 여러 개 → 반복되는 그룹(Repeating Group)

해결:

* 속성 분리, 혹은 별도 테이블로 분해

---

## 2️⃣ 제2정규형(2NF) — 부분 함수 종속 제거

조건:

* **1NF 충족 +**
* 복합키를 가진 테이블에서 “부분 종속(Partial FD)”이 없어야 함

예:

```
(학생ID, 강의ID) → 성적
학생ID → 학생이름   (부분 종속 → 2NF 위반)
```

해결:

* 학생은 Student 테이블로 분리
* 강의는 Course 테이블로 분리

---

## 3️⃣ 제3정규형(3NF) — 이행 함수 종속 제거

조건:

* **2NF 충족 +**
* 기본키 → 일반속성 → 또 다른 일반속성
  이라는 이행 종속 제거

예:

```
학과코드 → 학과명  
학생ID → 학과코드 → 학과명 (이행 종속 → 3NF 위반)
```

해결:

* 학과 테이블 분리

---

## 4️⃣ BCNF (Boyce-Codd Normal Form) — 결정자 정규형

조건:

* 모든 결정자(Determinant)가 반드시 후보키여야 한다.

3NF는 완전하지 않기 때문에 BCNF가 존재.

예:

```
교수ID → 강의실
강의실 → 과목ID   (강의실이 결정자이지만 후보키가 아님 → BCNF 위반)
```

해결:

* 테이블을 더 깊게 분해
* FD를 재조정

BCNF는 3NF보다 더 강력한 정규형이며
이상 발생 가능성을 최소화한다.

---

# 6️⃣ 정규화가 가져다주는 효과

### ✔ 데이터 중복 제거

### ✔ 갱신/삭제/삽입 이상 방지

### ✔ 데이터 무결성 보장

### ✔ 스키마 구조 간결

### ✔ 유지보수 용이

### ✔ 시스템 확장성 우수

### ✔ JOIN 기반의 정교한 모델 구성 가능

정규화는 데이터베이스가 **시간이 지나도 무너지지 않는 구조**가 되게 한다.

---

# 7️⃣ 정규화의 단점 (중요)

정규화는 만능이 아니다.

### ✔ 단점 1 — JOIN 증가

과도한 정규화는 JOIN 횟수를 폭증시켜 성능 저하 가능

### ✔ 단점 2 — 읽기(Read) 중심 시스템의 속도 저하

로그형/DW형 시스템에서는 정규화가 방해 요소가 될 수도 있음

### ✔ 단점 3 — 모델이 지나치게 복잡해질 수 있음

특히 3NF/BCNF까지 엄격하게 가면 테이블 수 증가

---

# 8️⃣ 역정규화(Denormalization) — 실무의 현실적인 절충

정규화는 “원칙”,
역정규화는 “현실 해결책”.

다음 상황에서는 역정규화를 고려한다:

* JOIN이 너무 많아 성능 저하
* 읽기 성능이 중요한 서비스(검색/피드/로그)
* 보고서/대시보드 조회용 스키마
* 동일 값이 너무 많은 외래키 조인
* 인덱스보다 중복된 데이터가 더 빠른 경우

예:
게시판 Post 테이블에 user_name을 중복 저장
→ JOIN 비용 절감

---

# 9️⃣ 정규화와 ERD 설계의 관계

* 정규화는 **논리 모델링 단계**에서 수행
* ERD는 정규화 결과를 시각적으로 표현
* 정규화가 잘 되면 ERD가 단순하고 깔끔함
* 정규화가 부족하면 중복/이상/복잡도 증가

정규화는 “제대로 된 ERD”의 기초이다.

---

# 🔟 실무 예시: 정규화가 필요한 흔한 테이블

### BEFORE (비정규)

| 학생ID | 학생명 | 강의1 | 강의2 | 강의3 |

문제:

* 강의 수 고정
* 학생-강의 N:M 관계 표현 불가능
* 강의명 중복
* Update/Delete 이상 발생

---

### AFTER (정규화 후)

1. Student
2. Course
3. StudentCourse (N:M 매핑)
   → 완전한 모델이 됨.

---

# 1️⃣1️⃣ 정규화 수준 선택 실무 가이드

* 트랜잭션 시스템(OLTP) → 최소 **3NF까지**
* 분석 시스템(OLAP) → **차원 모델링(Star Schema)**
* 로그/대용량 검색 시스템 → 역정규화
* 마이크로서비스 DB → ERD 단순화 + 정규화 minimal
* 금융/정부/정책 시스템 → BCNF까지 고려

---

# ✨ 최종 요약

> **정규화는 함수적 종속성 기반으로 이상을 제거하고 데이터 무결성과 구조적 안정성을 확보하기 위한 엔터티 분해 기법이다.
> 1NF–2NF–3NF–BCNF를 통해 중복을 제거하고, 좋은 ERD와 일관된 데이터 구조를 만든다.
> 과도한 정규화는 성능 문제를 유발할 수 있으므로 역정규화와 균형 있게 사용해야 한다.**

