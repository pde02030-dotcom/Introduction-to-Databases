# 테이블 생성
```sql
CREATE TABLE Student (
    student_id   INT AUTO_INCREMENT PRIMARY KEY,
    name         VARCHAR(50) NOT NULL,
    email        VARCHAR(100) NOT NULL UNIQUE,
    phone        VARCHAR(20),
    reg_date     DATETIME DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE Course (
    course_id   INT AUTO_INCREMENT PRIMARY KEY,
    title       VARCHAR(100) NOT NULL,
    instructor  VARCHAR(50) NOT NULL,
    fee         INT NOT NULL CHECK (fee >= 0),
    opened_at   DATE NOT NULL
);
CREATE TABLE Enrollment (
    enrollment_id   INT AUTO_INCREMENT PRIMARY KEY,
    student_id      INT NOT NULL,
    course_id       INT NOT NULL,
    enrolled_at     DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    payment_status  ENUM('PAID', 'CANCEL') NOT NULL,
    CONSTRAINT fk_enroll_student
        FOREIGN KEY (student_id)
        REFERENCES Student(student_id)
        ON DELETE CASCADE,
    CONSTRAINT fk_enroll_course
        FOREIGN KEY (course_id)
        REFERENCES Course(course_id)
        ON DELETE CASCADE
);
CREATE TABLE Exam (
    exam_id     INT AUTO_INCREMENT PRIMARY KEY,
    course_id   INT NOT NULL,
    exam_name   VARCHAR(100) NOT NULL,
    exam_date   DATE NOT NULL,
    CONSTRAINT fk_exam_course
        FOREIGN KEY (course_id)
        REFERENCES Course(course_id)
        ON DELETE CASCADE
);
CREATE TABLE Score (
    score_id    INT AUTO_INCREMENT PRIMARY KEY,
    student_id  INT NOT NULL,
    exam_id     INT NOT NULL,
    score       INT,
    CONSTRAINT fk_score_student
        FOREIGN KEY (student_id)
        REFERENCES Student(student_id)
        ON DELETE CASCADE,
    CONSTRAINT fk_score_exam
        FOREIGN KEY (exam_id)
        REFERENCES Exam(exam_id)
        ON DELETE CASCADE
);
```

## 외래키 제약 조건 예시
```sql
CREATE TABLE Member (
    id INT PRIMARY KEY,
    name VARCHAR(100)
);

CREATE TABLE Orders (
    id INT PRIMARY KEY,
    member_id INT,
    FOREIGN KEY (member_id) REFERENCES Member(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```

## 컬럼 추가
```sql
ALTER TABLE Student ADD birth_date DATE;
```

## 컬럼 변경
```sql
ALTER TABLE Course MODIFY instructor VARCHAR(80) NOT NULL;
```

## 테이블 이름 변경
```sql
ALTER TABLE Exam RENAME TO ExamInfo;
```

## 제약조건 추가
```sql
ALTER TABLE score ADD CONSTRAINT score_ck CHECK (score BETWEEN 0 AND 100);
```

## Update/Delete
```sql
UPDATE Enrollment SET payment_status = 'PAID' WHERE payment_status = 'CANCEL';
DELETE FROM Course WHERE fee >= 100000;
UPDATE Student SET email = 'kim.new@student.com' WHERE name = '김학생';
```

## LIKE
```sql
SELECT * FROM Student WHERE name LIKE '%김%';
```

## SUBSTR(subtract), LENGTH
```sql
SELECT email, SUBSTR(email, INSTR(email, '@') + 1) AS domain FROM Student;
ELECT title, LENGTH(title) AS title_length FROM Course;
```

## DATE_SUB, NOW
```sql
SELECT * FROM Enrollment WHERE enrolled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY);
SELECT * FROM Student WHERE reg_date IS NULL;
```

## 집계함수 + GROUP BY + LEFT JOIN
```sql
SELECT 
    c.course_id, c.title, COUNT(e.enrollment_id) AS enroll_count
FROM
    Course c
        LEFT JOIN
    Enrollment e ON c.course_id = e.course_id
GROUP BY c.course_id , c.title;
```
```sql
SELECT s.student_id, s.name, AVG(sc.score) AS avg_score 
FROM student s
INNER JOIN score sc ON s.student_id = sc.student_id 
GROUP BY s.student_id, s.name;
```
```sql
SELECT c.course_id, c.title, c.fee, count(e.enrollment_id) AS student_count, c.fee * count(e.enrollment_id) AS total_revenue
FROM course c 
JOIN enrollment e ON c.course_id = e.course_id 
WHERE e.payment_status = 'PAID'
group by c.course_id, c.title, c.fee;
```
```sql
SELECT instructor, COUNT(*) AS course_count 
FROM course 
GROUP BY instructor;
```
```sql
SELECT ei.exam_id, ei.exam_name, MAX(sc.score) AS max_score, MIN(sc.score) AS min_score
FROM examInfo ei 
JOIN score sc ON ei.exam_id = sc.exam_id
GROUP BY ei.exam_id, ei.exam_name;
```

## inner/left join
```sql
SELECT s.name AS student_name, c.title AS course_title 
FROM student s
JOIN enrollment e ON s.student_id = e.student_id 
JOIN course c ON e.course_id = c.course_id;
```
